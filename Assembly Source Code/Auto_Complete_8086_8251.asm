;====================================================================
; Main.asm file generated by New Project wizard
;
; Created:   Thu Dec 10 2020
; Processor: 8086
; Compiler:  MASM32
;
; Before starting simulation set Internal Memory Size 
; in the 8086 model properties to 0x10000
;====================================================================
STACKSG	SEGMENT PARA STACK 'STAK'
		     DW	20 DUP(?)
STACKSG	ENDS

DATASG		SEGMENT PARA 'DATA'
ARRAY	DB	53H, 49H, 72H, 66H, 61H, 6EH, 48H, 20H
HATA	DB	20H, 45H, 52H, 52H, 4FH, 52H, 20H
DATASG		ENDS

CODE    SEGMENT PUBLIC 'CODE'
        ASSUME CS:CODE, SS:STACKSG, DS:DATASG

START:
        ; Write your code here
	PUSH DS
	XOR AX, AX
	PUSH AX
	MOV AX, DATASG
	MOV DS, AX
	
	MOV DX, 020Ah
	MOV AL, 01001101B		; Set mode as asynchronous using MOD register
	OUT DX, AL
	
	MOV AL, 40H			; SOFT RESET 8251	, CONTROL REGISTER		0100 0000
	OUT DX, AL
	
	MOV AL, 01001101B		;  FIRST 2 BIT -> 1 STOP BIT,  NO PARITY, 8 DATA BITS,  ASYNCHRONOUS MODE BAUDRATE FACTOR 1, MODE REGISTER
	OUT DX, AL
	
	MOV AL, 00010101B		; ENABLE RECIEVE, ENABLE TRANSMIT
	OUT DX, AL
	
ENDLESS:

	MOV DX, 020AH
TEKRAR:
	IN AL, DX
	TEST AL, 02H			; WAIT TILL RXREADY IS SET		0000 0010
	JZ TEKRAR
	
	MOV DX, 0208H
	IN AL, DX				; GET DATA
	SUB AL, 48D
	CMP AL, 9D			; GIVE ERROR IF LENGTH IS GREATER THAN NAME
	JA ERROR
	XOR SI,SI
	CMP AL, 0H
	JZ FULLNAME
	CBW
	MOV CX, AX
	
DONGU:
	 MOV DX, 020Ah
TEKRAR2:
	IN AL, DX
	TEST AL, 02H			; WAIT TILL RxREADY IS SET		0000 0010
	JZ TEKRAR2
	
	MOV DX, 0208H
	IN AL,DX
	CMP AL, ARRAY[SI]		; GIVE ERROR IF THE LETTER IS NOT IN THE NAME
	JNE ERROR
	INC SI
	LOOP DONGU		

FULLNAME:
	MOV CX, 8D
	SUB CX, SI
	
DONGU2:	
	MOV DX, 020AH
TEKRAR3:
	IN AL, DX
	AND AL, 01H			; CHECK IF TXREADY IS SET		0000 0001
	JZ TEKRAR3
	
	MOV DX, 0208H
	MOV AL, ARRAY[SI]		; TRANSMIT THE LETTER TO THE TERMINAL
	OUT DX, AL
	INC SI
	LOOP DONGU2
	
	JMP DEVAM
	
ERROR: 
	   MOV CX, 7H	; WRITE ERROR INTO THE TERMINAL IF WRONG VALUES ARE ENTERED
	   XOR SI,SI
DONGU3:
	 MOV DX, 020AH
TEKRAR4:
	IN AL, DX
	AND AL, 01H
	JZ TEKRAR4
	
	MOV DX, 0208H
	MOV AL, HATA[SI]
	OUT DX, AL
	INC SI
	LOOP DONGU3

DEVAM:

        JMP ENDLESS
	



CODE    ENDS
        END START